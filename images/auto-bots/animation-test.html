<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bot Animation Test</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #1a1a1a;
            color: white;
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        canvas {
            border: 2px solid #444;
            background: #2a2a2a;
            margin: 20px;
        }

        .controls {
            background: #333;
            padding: 20px;
            border-radius: 8px;
            margin: 20px;
        }

        .control-group {
            margin: 10px 0;
        }

        label {
            display: inline-block;
            width: 180px;
        }

        input[type="range"] {
            width: 200px;
        }

        button {
            background: #4caf50;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
        }

        button:hover {
            background: #45a049;
        }

        .instructions {
            max-width: 800px;
            background: #333;
            padding: 20px;
            border-radius: 8px;
            margin: 20px;
        }

        .instructions h2 {
            color: #4caf50;
        }

        .instructions code {
            background: #222;
            padding: 2px 6px;
            border-radius: 3px;
            color: #4caf50;
        }
    </style>
</head>
<body>
    <h1>ü§ñ Bot Animation Test Lab</h1>

    <canvas id="botCanvas" width="600" height="400"></canvas>

    <div class="controls">
        <h3>Animation Controls</h3>

        <div class="control-group">
            <label>Propeller Speed:</label>
            <input type="range" id="propellerSpeed" min="0" max="20" value="5" step="0.5">
            <span id="propellerSpeedValue">5</span>
        </div>

        <div class="control-group">
            <label>Eye Blink Speed:</label>
            <input type="range" id="eyeBlinkSpeed" min="0" max="10" value="2" step="0.1">
            <span id="eyeBlinkSpeedValue">2</span>
        </div>

        <div class="control-group">
            <label>Eye Color:</label>
            <select id="eyeColorMode">
                <option value="green">Green (Normal)</option>
                <option value="blue">Blue (Normal)</option>
                <option value="red">Red (Alert)</option>
                <option value="blink-green-blue">Blink: Green/Blue</option>
                <option value="blink-green-red">Blink: Green/Red</option>
                <option value="rainbow">Rainbow Cycle</option>
            </select>
        </div>

        <div class="control-group">
            <label>Bot Size:</label>
            <input type="range" id="botSize" min="64" max="256" value="128" step="16">
            <span id="botSizeValue">128</span>px
        </div>

        <h3 style="margin-top: 20px; border-top: 1px solid #555; padding-top: 15px;">Eye Position Tweaking</h3>

        <div class="control-group">
            <label>Eye X Position:</label>
            <input type="range" id="eyeOffsetX" min="-50" max="50" value="0" step="1">
            <span id="eyeOffsetXValue">0</span>%
        </div>

        <div class="control-group">
            <label>Eye Y Position:</label>
            <input type="range" id="eyeOffsetY" min="-50" max="50" value="0" step="1">
            <span id="eyeOffsetYValue">0</span>%
        </div>

        <div class="control-group">
            <label>Eye Size:</label>
            <input type="range" id="eyeSize" min="4" max="20" value="10" step="1">
            <span id="eyeSizeValue">10</span>%
        </div>

        <div class="control-group">
            <label>Eye Glow:</label>
            <input type="range" id="eyeGlow" min="0" max="30" value="15" step="1">
            <span id="eyeGlowValue">15</span>
        </div>

        <div class="control-group">
            <button onclick="toggleAnimation()">‚è∏Ô∏è Pause/Resume</button>
            <button onclick="resetSettings()">üîÑ Reset Settings</button>
            <button onclick="saveSettings()">üíæ Save Settings</button>
            <button onclick="copySettings()">üìã Copy Settings</button>
        </div>

        <div id="settingsOutput" style="margin-top: 15px; padding: 10px; background: #222; border-radius: 4px; display: none;">
            <h4 style="margin-top: 0; color: #4caf50;">Your Settings:</h4>
            <pre id="settingsCode" style="background: #1a1a1a; padding: 10px; border-radius: 4px; overflow-x: auto; color: #0f0;"></pre>
            <button onclick="copyToClipboard()" style="background: #2196F3;">üìã Copy to Clipboard</button>
            <p style="font-size: 12px; color: #888; margin-bottom: 0;">These values have been saved to your browser and will persist when you refresh!</p>
        </div>
    </div>

    <div class="instructions">
        <h2>üìã How to Create Animated Bot Layers</h2>
        <p>To make your bot animations work, you need to split the original image into layers:</p>

        <h3>Step 1: Create Layer Files</h3>
        <p>Using an image editor (Photoshop, GIMP, Paint.NET, or Photopea.com), create these 3 files:</p>
        <ol>
            <li><code>plant-seeds-body.png</code> - The main body WITHOUT propellers or eye</li>
            <li><code>plant-seeds-propellers.png</code> - ONLY the propellers on transparent background</li>
            <li><code>plant-seeds-eye.png</code> - ONLY the eye area on transparent background (optional - we can draw it with code)</li>
        </ol>

        <h3>Step 2: Save files in this folder</h3>
        <p>Place the layer files in: <code>images/auto-bots/</code></p>

        <h3>Step 3: Test!</h3>
        <p>Refresh this page and the animations will automatically load your new layers!</p>

        <h3>Tips:</h3>
        <ul>
            <li>Make sure the layers are the SAME SIZE as the original image</li>
            <li>Use transparent (PNG) backgrounds for propellers and eye layers</li>
            <li>The eye can be drawn with code (colored circle) if you prefer</li>
            <li>Free online tool: <a href="https://www.photopea.com" target="_blank" style="color: #4caf50">Photopea.com</a> works like Photoshop</li>
        </ul>
    </div>

    <script>
        const canvas = document.getElementById('botCanvas');
        const ctx = canvas.getContext('2d');

        // Animation state
        let animationRunning = true;
        let startTime = Date.now();

        // Images
        const images = {
            original: new Image(),
            body: new Image(),
            propellers: new Image(),
            eye: new Image()
        };

        // Load images
        images.original.src = 'plant-seeds-original.png';
        images.body.src = 'plant-seeds-body.png';
        images.propellers.src = 'plant-seeds-propellers.png';
        images.eye.src = 'plant-seeds-eye.png';

        // Track which images loaded
        let loadedImages = new Set();

        Object.keys(images).forEach(key => {
            images[key].onload = () => {
                loadedImages.add(key);
            };
            images[key].onerror = () => {
                console.log(`Image ${key} not found (this is OK - will use fallback)`);
            };
        });

        // Get control values
        function getControls() {
            return {
                propellerSpeed: parseFloat(document.getElementById('propellerSpeed').value),
                eyeBlinkSpeed: parseFloat(document.getElementById('eyeBlinkSpeed').value),
                eyeColorMode: document.getElementById('eyeColorMode').value,
                botSize: parseInt(document.getElementById('botSize').value),
                eyeOffsetX: parseFloat(document.getElementById('eyeOffsetX').value),
                eyeOffsetY: parseFloat(document.getElementById('eyeOffsetY').value),
                eyeSize: parseFloat(document.getElementById('eyeSize').value),
                eyeGlow: parseFloat(document.getElementById('eyeGlow').value)
            };
        }

        // Update control display values
        document.getElementById('propellerSpeed').oninput = function() {
            document.getElementById('propellerSpeedValue').textContent = this.value;
        };
        document.getElementById('eyeBlinkSpeed').oninput = function() {
            document.getElementById('eyeBlinkSpeedValue').textContent = this.value;
        };
        document.getElementById('botSize').oninput = function() {
            document.getElementById('botSizeValue').textContent = this.value;
        };
        document.getElementById('eyeOffsetX').oninput = function() {
            document.getElementById('eyeOffsetXValue').textContent = this.value;
        };
        document.getElementById('eyeOffsetY').oninput = function() {
            document.getElementById('eyeOffsetYValue').textContent = this.value;
        };
        document.getElementById('eyeSize').oninput = function() {
            document.getElementById('eyeSizeValue').textContent = this.value;
        };
        document.getElementById('eyeGlow').oninput = function() {
            document.getElementById('eyeGlowValue').textContent = this.value;
        };

        // Get eye color based on mode and time
        function getEyeColor(mode, time) {
            const t = time * 0.001;

            switch(mode) {
                case 'green': return '#00ff00';
                case 'blue': return '#0088ff';
                case 'red': return '#ff0000';
                case 'blink-green-blue':
                    return Math.sin(t * getControls().eyeBlinkSpeed) > 0 ? '#00ff00' : '#0088ff';
                case 'blink-green-red':
                    return Math.sin(t * getControls().eyeBlinkSpeed) > 0 ? '#00ff00' : '#ff0000';
                case 'rainbow':
                    const hue = (t * 50) % 360;
                    return `hsl(${hue}, 100%, 50%)`;
                default: return '#00ff00';
            }
        }

        // Draw the animated bot
        function drawBot(x, y, time) {
            const controls = getControls();
            const size = controls.botSize;
            const centerX = x + size / 2;
            const centerY = y + size / 2;

            // If we have layered images, use them
            if (loadedImages.has('body') && loadedImages.has('propellers')) {
                // Draw body (static)
                ctx.drawImage(images.body, x, y, size, size);

                // Draw spinning propellers
                ctx.save();
                ctx.translate(centerX, centerY);
                ctx.rotate(time * 0.001 * controls.propellerSpeed);
                ctx.translate(-centerX, -centerY);
                ctx.drawImage(images.propellers, x, y, size, size);
                ctx.restore();

                // Draw animated eye (as a glowing circle)
                const eyeColor = getEyeColor(controls.eyeColorMode, time);

                // Calculate eye position with user controls
                const eyeX = centerX + (size * controls.eyeOffsetX / 100);
                const eyeY = centerY + (size * controls.eyeOffsetY / 100);
                const eyeRadius = size * (controls.eyeSize / 100);

                // Eye glow effect
                ctx.save();
                ctx.shadowBlur = controls.eyeGlow;
                ctx.shadowColor = eyeColor;
                ctx.fillStyle = eyeColor;
                ctx.beginPath();
                ctx.arc(eyeX, eyeY, eyeRadius, 0, Math.PI * 2);
                ctx.fill();
                ctx.restore();

            } else if (loadedImages.has('original')) {
                // Fallback: just draw the original (no wobble so you can see eye position clearly)
                ctx.drawImage(images.original, x, y, size, size);

                // Draw an animated eye overlay
                const eyeColor = getEyeColor(controls.eyeColorMode, time);

                // Calculate eye position with user controls
                const eyeX = centerX + (size * controls.eyeOffsetX / 100);
                const eyeY = centerY + (size * controls.eyeOffsetY / 100);
                const eyeRadius = size * (controls.eyeSize / 100);

                ctx.save();
                ctx.shadowBlur = controls.eyeGlow;
                ctx.shadowColor = eyeColor;
                ctx.fillStyle = eyeColor;
                ctx.beginPath();
                ctx.arc(eyeX, eyeY, eyeRadius, 0, Math.PI * 2);
                ctx.fill();
                ctx.restore();

                // Draw spinning propeller preview overlays
                // These show where the propellers are and how they'll spin
                const angle = time * 0.001 * controls.propellerSpeed;

                // Draw 4 propeller positions (2 on left, 2 on right)
                const propPositions = [
                    { x: centerX - size * 0.38, y: centerY - size * 0.15 }, // Top left
                    { x: centerX - size * 0.38, y: centerY + size * 0.15 }, // Bottom left
                    { x: centerX + size * 0.38, y: centerY - size * 0.15 }, // Top right
                    { x: centerX + size * 0.38, y: centerY + size * 0.15 }  // Bottom right
                ];

                ctx.save();
                ctx.strokeStyle = '#00ff0055';
                ctx.lineWidth = 3;
                ctx.lineCap = 'round';

                propPositions.forEach((pos, index) => {
                    const propAngle = angle + (index % 2) * Math.PI; // Alternate direction
                    const propLen = size * 0.15;

                    // Draw propeller blades (2 blades per propeller)
                    for (let blade = 0; blade < 2; blade++) {
                        const bladeAngle = propAngle + blade * Math.PI;
                        ctx.beginPath();
                        ctx.moveTo(
                            pos.x - Math.cos(bladeAngle) * propLen,
                            pos.y - Math.sin(bladeAngle) * propLen
                        );
                        ctx.lineTo(
                            pos.x + Math.cos(bladeAngle) * propLen,
                            pos.y + Math.sin(bladeAngle) * propLen
                        );
                        ctx.stroke();
                    }

                    // Draw hub
                    ctx.fillStyle = '#00ff0088';
                    ctx.beginPath();
                    ctx.arc(pos.x, pos.y, size * 0.02, 0, Math.PI * 2);
                    ctx.fill();
                });

                ctx.restore();

                // Draw note
                ctx.fillStyle = '#00ff0088';
                ctx.font = '12px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('Green overlays = propeller spin preview', centerX, y + size + 20);
            } else {
                // No images loaded yet - show loading message
                ctx.fillStyle = '#666';
                ctx.font = '16px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('Loading bot image...', centerX, centerY);
            }
        }

        // Animation loop
        function animate() {
            if (!animationRunning) {
                requestAnimationFrame(animate);
                return;
            }

            const currentTime = Date.now() - startTime;

            // Clear canvas
            ctx.fillStyle = '#2a2a2a';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Draw grid background
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 1;
            for (let x = 0; x < canvas.width; x += 50) {
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, canvas.height);
                ctx.stroke();
            }
            for (let y = 0; y < canvas.height; y += 50) {
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(canvas.width, y);
                ctx.stroke();
            }

            // Draw the bot in the center
            const controls = getControls();
            const x = (canvas.width - controls.botSize) / 2;
            const y = (canvas.height - controls.botSize) / 2;
            drawBot(x, y, currentTime);

            // Draw info
            ctx.fillStyle = '#4caf50';
            ctx.font = '14px monospace';
            ctx.textAlign = 'left';
            ctx.fillText(`Time: ${(currentTime / 1000).toFixed(2)}s`, 10, 20);
            ctx.fillText(`Loaded layers: ${Array.from(loadedImages).join(', ')}`, 10, 40);

            requestAnimationFrame(animate);
        }

        function toggleAnimation() {
            animationRunning = !animationRunning;
        }

        function resetSettings() {
            document.getElementById('propellerSpeed').value = 5;
            document.getElementById('eyeBlinkSpeed').value = 2;
            document.getElementById('eyeColorMode').value = 'green';
            document.getElementById('botSize').value = 128;
            document.getElementById('eyeOffsetX').value = 0;
            document.getElementById('eyeOffsetY').value = 0;
            document.getElementById('eyeSize').value = 10;
            document.getElementById('eyeGlow').value = 15;
            updateDisplayValues();
            saveToLocalStorage();
        }

        function updateDisplayValues() {
            document.getElementById('propellerSpeedValue').textContent = document.getElementById('propellerSpeed').value;
            document.getElementById('eyeBlinkSpeedValue').textContent = document.getElementById('eyeBlinkSpeed').value;
            document.getElementById('botSizeValue').textContent = document.getElementById('botSize').value;
            document.getElementById('eyeOffsetXValue').textContent = document.getElementById('eyeOffsetX').value;
            document.getElementById('eyeOffsetYValue').textContent = document.getElementById('eyeOffsetY').value;
            document.getElementById('eyeSizeValue').textContent = document.getElementById('eyeSize').value;
            document.getElementById('eyeGlowValue').textContent = document.getElementById('eyeGlow').value;
        }

        function saveSettings() {
            const settings = getControls();
            const output = document.getElementById('settingsOutput');
            const code = document.getElementById('settingsCode');

            const settingsText = `// Bot Animation Settings
const botAnimationConfig = {
  propellerSpeed: ${settings.propellerSpeed},
  eyeBlinkSpeed: ${settings.eyeBlinkSpeed},
  eyeColorMode: '${settings.eyeColorMode}',

  // Eye position and appearance
  eyeOffsetX: ${settings.eyeOffsetX},  // % of bot size
  eyeOffsetY: ${settings.eyeOffsetY},  // % of bot size
  eyeSize: ${settings.eyeSize},        // % of bot size
  eyeGlow: ${settings.eyeGlow}         // glow intensity
};

// How to use these values:
const eyeX = centerX + (botSize * ${settings.eyeOffsetX} / 100);
const eyeY = centerY + (botSize * ${settings.eyeOffsetY} / 100);
const eyeRadius = botSize * (${settings.eyeSize} / 100);`;

            code.textContent = settingsText;
            output.style.display = 'block';

            // Save to localStorage
            saveToLocalStorage();

            // Scroll to show the output
            output.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        function copySettings() {
            saveSettings(); // This will show the settings first
        }

        function copyToClipboard() {
            const code = document.getElementById('settingsCode');
            navigator.clipboard.writeText(code.textContent).then(() => {
                alert('‚úÖ Settings copied to clipboard!');
            }).catch(err => {
                // Fallback for older browsers
                const textarea = document.createElement('textarea');
                textarea.value = code.textContent;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                alert('‚úÖ Settings copied to clipboard!');
            });
        }

        function saveToLocalStorage() {
            const settings = {
                propellerSpeed: document.getElementById('propellerSpeed').value,
                eyeBlinkSpeed: document.getElementById('eyeBlinkSpeed').value,
                eyeColorMode: document.getElementById('eyeColorMode').value,
                botSize: document.getElementById('botSize').value,
                eyeOffsetX: document.getElementById('eyeOffsetX').value,
                eyeOffsetY: document.getElementById('eyeOffsetY').value,
                eyeSize: document.getElementById('eyeSize').value,
                eyeGlow: document.getElementById('eyeGlow').value
            };
            localStorage.setItem('botAnimationSettings', JSON.stringify(settings));
        }

        function loadFromLocalStorage() {
            const saved = localStorage.getItem('botAnimationSettings');
            if (saved) {
                try {
                    const settings = JSON.parse(saved);
                    document.getElementById('propellerSpeed').value = settings.propellerSpeed || 5;
                    document.getElementById('eyeBlinkSpeed').value = settings.eyeBlinkSpeed || 2;
                    document.getElementById('eyeColorMode').value = settings.eyeColorMode || 'green';
                    document.getElementById('botSize').value = settings.botSize || 128;
                    document.getElementById('eyeOffsetX').value = settings.eyeOffsetX || 0;
                    document.getElementById('eyeOffsetY').value = settings.eyeOffsetY || 0;
                    document.getElementById('eyeSize').value = settings.eyeSize || 10;
                    document.getElementById('eyeGlow').value = settings.eyeGlow || 15;
                    updateDisplayValues();
                } catch (e) {
                    console.log('Could not load saved settings');
                }
            }
        }

        // Auto-save when sliders change
        document.querySelectorAll('input[type="range"], select').forEach(input => {
            input.addEventListener('change', saveToLocalStorage);
        });

        // Load saved settings on page load
        loadFromLocalStorage();

        // Start animation
        animate();
    </script>
</body>
</html>
